#create deseq matrix for condition
dds <- DESeqDataSetFromMatrix(countData=gene_counts,
colData=metadata,
design=~condition, tidy=TRUE)
d.dds <- DESeq(dds)
#transofrm deseq data
vs_cond_data <- varianceStabilizingTransformation(d.dds)
#visualize PCA
plotPCA(vs_cond_data,intgroup=c('condition'))
ggsave('../results/pca.png',dpi=200)
#get gene names from Ensembl gene id
#create Ensembl query
ensembl <- useEnsembl(biomart='genes',
dataset='btaurus_gene_ensembl',
mirror='useast')
#get gene names from Ensembl gene id
#create Ensembl query
ensembl <- useEnsembl(biomart='genes',
dataset='btaurus_gene_ensembl',
mirror='uswest')
#get data
gene_names <- getBM(attributes=c('external_gene_name','ensembl_gene_id'),
filters=c('ensembl_gene_id'),
values=gene_counts$gene_id,
mart=ensembl)
res <- results(d.dds,
contrast=c('condition','lda','non_lda'))
res <- results(d.dds,
contrast=c('condition','lda','control'))
res <- lfcShrink(d.dds,
contrast=c('condition','lda','control'),
res=res,
type='normal')
#visualize volcano plot
EnhancedVolcano(res,
lab=gene_names$external_gene_name,
x='log2FoldChange',
y='pvalue',
xlim=c(-6,6),
ylim=c(0,10))
ggsave('../results/volcano.png',dpi=200)
#visualize volcano plot
EnhancedVolcano(res,
lab=gene_names$external_gene_name,
title='',
x='log2FoldChange',
y='pvalue',
xlim=c(-6,6),
ylim=c(0,10))
ggsave('../results/volcano.png',dpi=200)
#gsea https://learn.gencore.bio.nyu.edu/rna-seq-analysis/gene-set-enrichment-analysis/
organism = "org.Bt.eg.db"
#BiocManager::install(organism, character.only = TRUE)
library(organism, character.only = TRUE)
#get fc values
original_gene_list <- res$log2FoldChange
#name gene list
names(original_gene_list) <- rownames(res)
# omit any NA values
gene_list<-na.omit(original_gene_list)
# sort the list in decreasing order (required for clusterProfiler)
gene_list = sort(gene_list, decreasing = TRUE)
#gsea
gse <- gseGO(geneList=gene_list,
ont ="ALL",
keyType = "ENSEMBL",
nPerm = 10000,
minGSSize = 3,
maxGSSize = 800,
pvalueCutoff = 0.05,
verbose = TRUE,
OrgDb = organism,
pAdjustMethod = "none")
dotplot(gse, showCategory=10, split=".sign") + facet_grid(.~.sign)+
labs(y='GO terms')+
theme(axis.text.y=element_text(size=8))
ggsave('../results/go_enrichment.png',dpi=200)
de <- names(geneList)[abs(geneList) > 2]
de <- names(gene_list)[abs(geneList) > 2]
de <- names(gene_list)[abs(gene_list) > 2]
edo <- enrichDGN(de)
library(DOSE)
de <- names(gene_list)[abs(gene_list) > 2]
de
edo <- enrichDGN(de)
edo
de
res
gene_list
original_gene_list
res
gene_names
res
entrez_res <- res
names(entrez_res)
class(entrez_res)
rownames(entrez_res)
gene_names
gene_names&external_gene_names
gene_names&external_gene_name
rownames(entrez_res) <-
gene_names
gene_names
gene_names$external_gene_name
rownames(entrez_res) <- gene_names$external_gene_name
entrez_res
#get fc values
entrez_gene_list <- entrez_res$log2FoldChange
#name gene list
names(entrez_gene_list) <- rownames(entrez_res)
# omit any NA values
entrez_gene_list<-na.omit(entrez_gene_list)
# sort the list in decreasing order (required for clusterProfiler)
entrez_gene_list = sort(entrez_gene_list, decreasing = TRUE)
entrez_gene_list
de <- names(entrez_gene_list)[abs(entrez_gene_list) > 2]
de
entrez_res
entrez_res.drop(entrez_res.index[[""]])
entrez_res[-c("")]
entrez_res[-"",]
gene_names$external_gene_name
class(gene_names$external_gene_name)
gene_names$external_gene_name[!""]
trial <- gene_names$external_gene_name
trial
trial[trial!=""]
entrez_re[trial[trial!=""]]
entrez_res[trial[trial!=""]]
trial <- trial[trial!=""]
trial
entrez_res[trial]
trial
entrez_res[trial,]
non_missing <- non_missing[non_missing!=""]
non_missing <- gene_names$external_gene_name
non_missing <- non_missing[non_missing!=""]
non_missing
entrez_res <- entrez_res[non_missing,]
entrez_res[trial,]
#get fc values
entrez_gene_list <- entrez_res$log2FoldChange
#name gene list
names(entrez_gene_list) <- rownames(entrez_res)
# omit any NA values
entrez_gene_list<-na.omit(entrez_gene_list)
# sort the list in decreasing order (required for clusterProfiler)
entrez_gene_list = sort(entrez_gene_list, decreasing = TRUE)
de <- names(entrez_gene_list)[abs(entrez_gene_list) > 2]
edo <- enrichDGN(de)
de
emapplot(
req,
layout='circle',
cex_category=1.5
readable=TRUE
emapplot(
req,
layout='circle',
cex_category=1.5,
readable=TRUE
)
#enrichment map
req <- pairwise_termsim(gse)
emapplot(
req,
layout='circle',
cex_category=1.5,
readable=TRUE
)
emapplot(
req,
layout='kk',
cex_category=1.5,
readable=TRUE
)
emapplot(
req,
layout='kk',
cex_category=1.5,
readable=TRUE,
pie='count'
)
detach("package:enrichplot", unload = TRUE)
library(enrichplot)
#enrichment map
BiocManager::install("enrichplot")
req <- pairwise_termsim(gse)
emapplot(
req,
layout='kk',
cex_category=1.5,
readable=TRUE,
pie='count'
)
emapplot(
req,
layout='circle',
readable=TRUE
)
emapplot(
req,
layout='circle',
readable=TRUE,
cex_label_category=2
)
emapplot(
req,
layout='circle',
readable=TRUE,
cex_label_category=0.2
)
emapplot(
req,
layout='kk',
readable=TRUE,
cex_label_category=0.2
)
emapplot(
req,
layout='kk',
readable=TRUE,
cex_label_category=0.8
)
emapplot(
req,
layout='circle',
readable=TRUE,
cex_label_category=0.8
)
emapplot(
req,
layout='circle',
readable=TRUE,
cex_category=2,
cex_label_category=0.8
)
emapplot(
req,
layout='circle',
readable=TRUE,
cex_category=1,
cex_label_category=0.8
)
emapplot(
req,
layout='circle',
cex_category=1,
cex_label_category=0.8
)
emapplot(
req,
layout='circle',
cex_category=1.5,
cex_label_category=0.8
)
emapplot(
req,
layout='kk',
cex_category=1.5,
cex_label_category=0.8
)
??emapplot
emapplot(
req,
layout='kk',
cex_category=1.5,
cex_label_category=0.8,
repel=FALSE
)
emapplot(
req,
layout='circle',
cex_category=1.5,
cex_label_category=0.8,
repel=FALSE
)
emapplot(
req,
layout='circle',
cex_category=1.5,
cex_label_category=0.8,
repel=FALSE,
label_format=20
)
emapplot(
req,
layout='circle',
cex_category=1.5,
cex_label_category=0.8,
repel=FALSE,
label_format=10
)
emapplot(
req,
layout='circle',
cex_category=1.5,
cex_label_category=0.8,
repel=FALSE,
label_format=10,
force=TRUE
)
emapplot(
req,
layout='kk',
cex_category=1.5,
cex_label_category=0.8,
repel=FALSE,
label_format=10,
force=TRUE
)
emapplot(
req,
layout='kk',
cex_category=1.5,
cex_label_category=0.8,
repel=FALSE,
label_format=10,
force=TRUE,
direction='both'
)
emapplot(
req,
layout='circle',
cex_category=1.5,
cex_label_category=0.8,
repel=FALSE,
label_format=10,
force=TRUE,
direction='both'
)
emapplot(
req
)
emapplot(
req,
repel=TRUE
)
emapplot(
req,
repel=TRUE,
cex_label_category=10
)
emapplot(
req,
repel=TRUE,
cex_label_category=5
)
emapplot(
req,
repel=TRUE,
cex_label_category=.5
)
ggsave('../results/network.png',dpi=200)
emapplot(
req,
repel=TRUE,
cex_label_category=.5,
group_category=TRUE
)
emapplot(
req,
repel=TRUE,
cex_label_category=.75,
group_category=TRUE
)
emapplot(
req,
repel=TRUE,
cex_label_category=.65,
group_category=TRUE
)
req
rep$Description
gse
gene_list
#gsea
gse <- gseGO(geneList=gene_list,
ont ="GO",
keyType = "ENSEMBL",
nPerm = 10000,
minGSSize = 3,
maxGSSize = 800,
pvalueCutoff = 0.05,
verbose = TRUE,
OrgDb = organism,
pAdjustMethod = "none")
ALL
#gsea
gse <- gseGO(geneList=gene_list,
ont ="ALL",
keyType = "ENSEMBL",
nPerm = 10000,
minGSSize = 3,
maxGSSize = 800,
pvalueCutoff = 0.05,
verbose = TRUE,
OrgDb = organism,
pAdjustMethod = "none")
dotplot(gse, showCategory=10, split=".sign") + facet_grid(.~.sign)+
labs(y='GO terms')+
theme(axis.text.y=element_text(size=8))
emapplot(
req,
repel=TRUE,
cex_label_category=.65,
group_category=TRUE
)
emapplot(
req,
repel=TRUE,
cex_label_category=.5,
group_category=TRUE
)
emapplot(
req,
repel=TRUE,
cex_label_category=.55,
group_category=TRUE
)
emapplot(
req,
layout='circle',
repel=TRUE,
cex_label_category=.55,
group_category=TRUE
)
emapplot(
req,
layout='gem',
repel=TRUE,
cex_label_category=.55,
group_category=TRUE
)
emapplot(
req,
layout='gem',
repel=TRUE,
cex_label_category=.85,
group_category=TRUE
)
emapplot(
req,
layout='dh',
repel=TRUE,
cex_label_category=.5,
group_category=TRUE
)
emapplot(
req,
layout='graphopt',
repel=TRUE,
cex_label_category=.5,
group_category=TRUE
)
emapplot(
req,
layout='grid',
repel=TRUE,
cex_label_category=.5,
group_category=TRUE
)
emapplot(
req,
layout='grid',
repel=TRUE,
cex_label_category=.55,
group_category=TRUE
)
emapplot(
req,
layout='mds',
repel=TRUE,
cex_label_category=.55,
group_category=TRUE
)
emapplot(
req,
layout='randomly',
repel=TRUE,
cex_label_category=.55,
group_category=TRUE
)
emapplot(
req,
layout='fr',
repel=TRUE,
cex_label_category=.55,
group_category=TRUE
)
emapplot(
req,
layout='drl',
repel=TRUE,
cex_label_category=.55,
group_category=TRUE
)
emapplot(
req,
layout='lgl',
repel=TRUE,
cex_label_category=.55,
group_category=TRUE
)
emapplot(
req,
layout='grid',
repel=TRUE,
cex_label_category=.55,
group_category=TRUE
)
ggsave('../results/network.png',dpi=200)
